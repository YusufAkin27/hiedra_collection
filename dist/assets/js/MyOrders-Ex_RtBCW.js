import{u as e,r,j as t,L as i}from"./react-vendor-2SZXphvN.js";import{a as o}from"./context-Fvoum6Gs.js";import{S as s}from"./SEO-CLq8vwqd.js";import{L as n}from"./LazyImage-CsJsGg8n.js";import"./vendor-invariant-BME_2b6A.js";import"./vendor-shallowequal-CcIhOdxx.js";import"./vendor-scheduler-BVKd3TJG.js";import"./vendor-@remix-run-BWfEV5os.js";import"./index-CXfDXBCE.js";const a="http://localhost:8080/api",l=()=>{const{user:l,isAuthenticated:d,accessToken:c,logout:u}=o(),m=e(),[p,g]=r.useState([]),[h,f]=r.useState(!0),[b,y]=r.useState(""),[x,j]=r.useState(""),[k,v]=r.useState({}),[N,S]=r.useState({}),[E,w]=r.useState(null),[z,I]=r.useState(0),[T,C]=r.useState(""),[D,A]=r.useState([]),[L,R]=r.useState([]),[F,B]=r.useState(!1),[P,W]=r.useState({});r.useEffect(()=>{d?M():m("/giris")},[d,l,c]),r.useEffect(()=>{p.length>0&&l?.email&&p.forEach(e=>{!e.trackingNumber||k[e.orderNumber]||N[e.orderNumber]||U(e)})},[p,l?.email]);const M=async()=>{if(!l?.email)return y("KullanÄ±cÄ± bilgisi bulunamadÄ±"),void f(!1);try{f(!0),y("");const e=await fetch(a+"/orders/my-orders",{method:"GET",headers:{"Content-Type":"application/json",...c&&{Authorization:"Bearer "+c}}});if(!e.ok){if(401===e.status)throw Error("Oturum sÃ¼reniz dolmuÅŸ. LÃ¼tfen tekrar giriÅŸ yapÄ±n.");if(404===e.status)return void g([]);{const r=await e.json().catch(()=>({}));throw Error(r.message||`SipariÅŸler yÃ¼klenemedi (${e.status})`)}}const r=await e.json();if(r.isSuccess||r.success){const e=r.data||[];g(e)}else g([]),y(r.message||"SipariÅŸler yÃ¼klenemedi")}catch(e){y(e.message||"SipariÅŸler yÃ¼klenirken bir hata oluÅŸtu")}finally{f(!1)}},O=e=>{if(!e)return"status-unknown";const r=e.toUpperCase();return"DELIVERED"===r?"status-delivered":"SHIPPED"===r?"status-shipped":"PROCESSING"===r||"PAID"===r?"status-processing":"CANCELLED"===r||"REFUNDED"===r?"status-cancelled":"REFUND_REQUESTED"===r?"status-refund":"status-pending"},U=async e=>{if(!e.trackingNumber||!l?.email)return;const r=e.orderNumber;if(!N[r]&&!k[r])try{S(e=>({...e,[r]:!0}));const t=new URL(a+"/shipping/track-by-order");t.searchParams.append("orderNumber",e.orderNumber),t.searchParams.append("email",l.email);const i=await fetch(t.toString(),{method:"GET",headers:{"Content-Type":"application/json",...c&&{Authorization:"Bearer "+c}}}),o=await i.json();(o.isSuccess||o.success)&&v(e=>({...e,[r]:o.data}))}catch(t){}finally{S(e=>({...e,[r]:!1}))}},Y=e=>e?{IN_TRANSIT:"Kargoda",DELIVERED:"Teslim Edildi",EXCEPTION:"Sorun Var",PENDING:"Beklemede",PICKED_UP:"Kargo AlÄ±ndÄ±",OUT_FOR_DELIVERY:"Teslimat Ä°Ã§in Yola Ã‡Ä±ktÄ±"}[e.toUpperCase()]||e:"Bilinmiyor",H=()=>{w(null),I(0),C(""),A([]),R([])};return r.useEffect(()=>{(async()=>{if(!p.length||!c)return void W({});const e=new Set;for(const t of p)if(("DELIVERED"===t.status||"TESLIM_EDILDI"===t.status)&&t.orderItems)for(const r of t.orderItems)r.productId&&e.add(r.productId);if(0!==e.size)try{const r=await fetch(a+"/reviews/check-multiple",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+c},body:JSON.stringify(Array.from(e))});if(r.ok){const e=await r.json();if(e.isSuccess&&e.data){const r={};Object.keys(e.data).forEach(t=>{if(!0===e.data[t]){const e=+t;r[e]=!0,r[e+""]=!0}}),W(r)}else W({})}else W({})}catch(r){W({})}else W({})})()},[p,c]),d?t.jsxs("div",{className:"my-orders-container",children:[t.jsx(s,{title:"SipariÅŸlerim - Hiedra Perde",description:"SipariÅŸlerinizi gÃ¶rÃ¼ntÃ¼leyin ve takip edin",url:"/siparislerim"}),t.jsxs("header",{className:"my-orders-header",children:[t.jsx("h1",{children:"SipariÅŸlerim"}),t.jsx("p",{children:"TÃ¼m sipariÅŸlerinizi buradan gÃ¶rÃ¼ntÃ¼leyebilir ve takip edebilirsiniz"})]}),b&&!h&&t.jsx("div",{className:"error-message",style:{margin:"1rem",padding:"1rem",backgroundColor:"#fee",color:"#c33",borderRadius:"4px"},children:b}),x&&t.jsx("div",{className:"success-message",style:{margin:"1rem",padding:"1rem",backgroundColor:"#efe",color:"#3c3",borderRadius:"4px"},children:x}),h?t.jsxs("div",{className:"loading-state",children:[t.jsx("div",{className:"loading-spinner"}),t.jsx("p",{children:"SipariÅŸler yÃ¼kleniyor..."})]}):b&&0===p.length?t.jsxs("div",{className:"error-state",children:[t.jsx("p",{children:b}),t.jsx("button",{onClick:M,className:"retry-btn",children:"Tekrar Dene"})]}):0===p.length?t.jsxs("div",{className:"empty-state",children:[t.jsxs("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[t.jsx("path",{d:"M9 2L7 6m6-4l2 4M3 8h18l-1 8H4L3 8z"}),t.jsx("circle",{cx:"7",cy:"20",r:"2"}),t.jsx("circle",{cx:"17",cy:"20",r:"2"})]}),t.jsx("h2",{children:"HenÃ¼z sipariÅŸiniz yok"}),t.jsx("p",{children:"Ä°lk sipariÅŸinizi vermek iÃ§in Ã¼rÃ¼nlerimizi inceleyin"}),t.jsx(i,{to:"/",className:"shop-btn",children:"AlÄ±ÅŸveriÅŸe BaÅŸla"})]}):t.jsx("div",{className:"orders-list",children:p.map(e=>{return t.jsxs("div",{className:"order-card",onClick:()=>m("/siparis/"+e.orderNumber),role:"button",tabIndex:0,onKeyDown:r=>{"Enter"!==r.key&&" "!==r.key||(r.preventDefault(),m("/siparis/"+e.orderNumber))},"aria-label":`SipariÅŸ ${e.orderNumber} detaylarÄ±nÄ± gÃ¶rÃ¼ntÃ¼le`,children:[t.jsxs("div",{className:"order-card-header",children:[t.jsxs("div",{className:"order-info",children:[t.jsxs("h3",{children:["SipariÅŸ No: ",e.orderNumber]}),t.jsx("span",{className:"status-badge "+O(e.status),children:(r=e.status,r?{PENDING:"Beklemede",PAID:"Ã–dendi",PROCESSING:"HazÄ±rlanÄ±yor",SHIPPED:"Kargoya Verildi",DELIVERED:"Teslim Edildi",CANCELLED:"Ä°ptal Edildi",REFUNDED:"Ä°ade Edildi",REFUND_REQUESTED:"Ä°ade Talebi"}[r.toUpperCase()]||r:"Bilinmiyor")})]}),t.jsxs("div",{className:"order-date",children:[t.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[t.jsx("circle",{cx:"12",cy:"12",r:"10"}),t.jsx("polyline",{points:"12 6 12 12 16 14"})]}),e.createdAt?new Date(e.createdAt).toLocaleDateString("tr-TR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Tarih bilgisi yok"]})]}),t.jsx("div",{className:"order-items-preview",children:e.orderItems&&e.orderItems.length>0?t.jsx(t.Fragment,{children:e.orderItems.map((r,i)=>{let o=r.productImageUrl||"/images/perde1kapak.jpg";o&&""!==o&&"null"!==o&&"undefined"!==o||(o="/images/perde1kapak.jpg"),o.startsWith("http")||o.startsWith("/")||(o="/"+o);const s=("DELIVERED"===e.status||"TESLIM_EDILDI"===e.status)&&r.productId,a=P[r.productId]||P[r.productId+""]||P[+r.productId];return t.jsxs("div",{className:"order-item-preview",children:[t.jsx("div",{className:"order-item-image-wrapper",children:t.jsx(n,{src:o,alt:r.productName||"ÃœrÃ¼n",className:"order-item-image"})}),t.jsxs("div",{className:"order-item-info",children:[t.jsx("span",{className:"item-name",children:r.productName||"ÃœrÃ¼n"}),r.quantity>1&&t.jsxs("span",{className:"item-quantity",children:["Adet: ",r.quantity]}),s&&(a?t.jsxs("div",{className:"review-btn review-btn-completed",children:[t.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:t.jsx("path",{d:"M20 6L9 17l-5-5"})}),t.jsx("span",{children:"Yorum YapÄ±ldÄ±"})]}):t.jsxs("button",{onClick:e=>{e.stopPropagation(),((e,r,t)=>{P[e]?y("Bu Ã¼rÃ¼ne zaten yorum yaptÄ±nÄ±z. Her Ã¼rÃ¼ne sadece bir kez yorum yapabilirsiniz."):(w({productId:e,productName:r,productImage:t}),I(0),C(""),A([]),R([]),y(""))})(r.productId,r.productName,o)},className:"review-btn review-btn-active",title:"Bu Ã¼rÃ¼ne yorum yap",children:[t.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:t.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),t.jsx("span",{children:"Yorum Yap"})]}))]})]},r.id||i)})}):t.jsx("p",{className:"no-items-text",children:"SipariÅŸ detayÄ± bulunamadÄ±"})}),e.trackingNumber&&t.jsxs("div",{className:"order-tracking-section",onClick:e=>e.stopPropagation(),style:{padding:"1rem",marginTop:"1rem",backgroundColor:"#f8f9fa",borderRadius:"8px",border:"1px solid #e0e0e0"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[t.jsxs("div",{children:[t.jsx("strong",{children:"Kargo Takip:"})," ",e.trackingNumber,e.carrier&&t.jsxs("span",{style:{marginLeft:"0.5rem",color:"#64748b"},children:["(",e.carrier,")"]})]}),t.jsx("button",{onClick:r=>{r.stopPropagation(),U(e)},disabled:N[e.orderNumber],style:{padding:"0.25rem 0.75rem",background:"#667eea",color:"white",border:"none",borderRadius:"4px",cursor:N[e.orderNumber]?"not-allowed":"pointer",fontSize:"0.85rem",opacity:N[e.orderNumber]?.6:1},children:N[e.orderNumber]?"YÃ¼kleniyor...":"GÃ¼ncelle"})]}),k[e.orderNumber]?t.jsxs("div",{style:{marginTop:"0.75rem"},children:[t.jsx("div",{style:{display:"inline-block",padding:"0.25rem 0.75rem",borderRadius:"4px",fontSize:"0.9rem",fontWeight:"600",backgroundColor:"DELIVERED"===k[e.orderNumber].status?"#d4edda":"IN_TRANSIT"===k[e.orderNumber].status?"#d1ecf1":"EXCEPTION"===k[e.orderNumber].status?"#f8d7da":"#fff3cd",color:"DELIVERED"===k[e.orderNumber].status?"#155724":"IN_TRANSIT"===k[e.orderNumber].status?"#0c5460":"EXCEPTION"===k[e.orderNumber].status?"#721c24":"#856404"},children:Y(k[e.orderNumber].status)}),k[e.orderNumber].statusDescription&&t.jsx("p",{style:{marginTop:"0.5rem",fontSize:"0.9rem",color:"#64748b"},children:k[e.orderNumber].statusDescription}),k[e.orderNumber].events&&k[e.orderNumber].events.length>0&&t.jsxs("div",{style:{marginTop:"0.75rem",fontSize:"0.85rem",color:"#64748b"},children:[t.jsx("strong",{children:"Son Hareket:"})," ",k[e.orderNumber].events[0].description||"Bilgi yok",k[e.orderNumber].events[0].location&&t.jsxs("span",{style:{marginLeft:"0.5rem"},children:["ðŸ“ ",k[e.orderNumber].events[0].location]})]}),t.jsx(i,{to:`/kargo-takip?trackingNumber=${e.trackingNumber}&orderNumber=${e.orderNumber}`,onClick:e=>e.stopPropagation(),style:{display:"inline-block",marginTop:"0.75rem",color:"#667eea",textDecoration:"none",fontSize:"0.9rem",fontWeight:"600"},children:"â†’ DetaylÄ± Takip Bilgisi"})]}):t.jsx(i,{to:`/kargo-takip?trackingNumber=${e.trackingNumber}&orderNumber=${e.orderNumber}`,onClick:e=>e.stopPropagation(),style:{display:"inline-block",marginTop:"0.5rem",color:"#667eea",textDecoration:"none",fontSize:"0.9rem",fontWeight:"600"},children:"â†’ Kargo Durumunu GÃ¶rÃ¼ntÃ¼le"})]}),t.jsx("div",{className:"order-card-footer",children:t.jsxs("div",{className:"order-total",children:[t.jsx("span",{children:"Toplam:"}),t.jsxs("span",{className:"total-amount",children:[(()=>{if(void 0!==e.totalAmount&&null!==e.totalAmount){const r="string"==typeof e.totalAmount?parseFloat(e.totalAmount):parseFloat(e.totalAmount.toString());if(!isNaN(r)&&r>0)return r.toFixed(2)}if(e.orderItems&&e.orderItems.length>0){let r=0;if(e.orderItems.forEach(e=>{const t=e.price?"string"==typeof e.price?parseFloat(e.price):parseFloat(e.price.toString()):0,i=e.quantity||1;r+=t*i}),r>0){const t=e.shippingCost&&null!==e.shippingCost?"string"==typeof e.shippingCost?parseFloat(e.shippingCost):parseFloat(e.shippingCost.toString()):0,i=e.discountAmount&&null!==e.discountAmount?"string"==typeof e.discountAmount?parseFloat(e.discountAmount):parseFloat(e.discountAmount.toString()):0,o=e.taxAmount&&null!==e.taxAmount?"string"==typeof e.taxAmount?parseFloat(e.taxAmount):parseFloat(e.taxAmount.toString()):0,s=r+t-i+o;return s>0?s.toFixed(2):r.toFixed(2)}}if(void 0!==e.subtotal&&null!==e.subtotal){const r="string"==typeof e.subtotal?parseFloat(e.subtotal):parseFloat(e.subtotal.toString());if(!isNaN(r)&&r>0){const t=r+(e.shippingCost&&null!==e.shippingCost?"string"==typeof e.shippingCost?parseFloat(e.shippingCost):parseFloat(e.shippingCost.toString()):0)-(e.discountAmount&&null!==e.discountAmount?"string"==typeof e.discountAmount?parseFloat(e.discountAmount):parseFloat(e.discountAmount.toString()):0)+(e.taxAmount&&null!==e.taxAmount?"string"==typeof e.taxAmount?parseFloat(e.taxAmount):parseFloat(e.taxAmount.toString()):0);return t>0?t.toFixed(2):r.toFixed(2)}}return"0.00"})()," â‚º"]})]})})]},e.id||e.orderNumber);var r})}),E&&t.jsx("div",{className:"review-modal-overlay",style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.75)",backdropFilter:"blur(4px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4,padding:"1rem",animation:"fadeIn 0.2s ease-out"},onClick:H,children:t.jsxs("div",{className:"review-modal",style:{background:"white",borderRadius:"20px",padding:0,maxWidth:"650px",width:"100%",maxHeight:"90vh",overflow:"hidden",boxShadow:"0 25px 80px rgba(0, 0, 0, 0.4)",display:"flex",flexDirection:"column",animation:"slideUp 0.3s ease-out"},onClick:e=>e.stopPropagation(),children:[t.jsxs("div",{style:{background:"#ffffff",padding:"1.5rem 2rem",borderBottom:"1px solid #e5e7eb",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("div",{children:[t.jsx("h2",{style:{margin:0,fontSize:"1.5rem",fontWeight:"600",color:"#1f2937"},children:"ÃœrÃ¼n Yorumu"}),t.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.875rem",color:"#6b7280"},children:"Deneyiminizi paylaÅŸÄ±n"})]}),t.jsx("button",{onClick:H,style:{background:"#f3f4f6",border:"none",borderRadius:"50%",width:"32px",height:"32px",cursor:"pointer",color:"#6b7280",fontSize:"1.25rem",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s",lineHeight:1},onMouseEnter:e=>{e.currentTarget.style.background="#e5e7eb",e.currentTarget.style.color="#374151"},onMouseLeave:e=>{e.currentTarget.style.background="#f3f4f6",e.currentTarget.style.color="#6b7280"},children:"Ã—"})]}),t.jsxs("div",{style:{padding:"2rem",overflowY:"auto",flex:1},children:[t.jsxs("div",{style:{display:"flex",gap:"1rem",marginBottom:"2rem",padding:"1rem",background:"#f9fafb",borderRadius:"8px",border:"1px solid #e5e7eb"},children:[t.jsx("img",{src:E.productImage,alt:E.productName,style:{width:"80px",height:"80px",objectFit:"cover",borderRadius:"8px",border:"1px solid #e5e7eb"}}),t.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center"},children:[t.jsx("h3",{style:{margin:0,fontSize:"1rem",fontWeight:"600",color:"#1f2937",marginBottom:"0.25rem"},children:E.productName}),t.jsx("p",{style:{margin:0,fontSize:"0.8125rem",color:"#9ca3af"},children:"ÃœrÃ¼n hakkÄ±ndaki gÃ¶rÃ¼ÅŸleriniz bizim iÃ§in deÄŸerli"})]})]}),t.jsxs("div",{style:{marginBottom:"2rem"},children:[t.jsxs("label",{style:{display:"block",marginBottom:"1rem",fontWeight:"600",fontSize:"0.9375rem",color:"#374151"},children:["PuanÄ±nÄ±z ",t.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),t.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"flex-start",alignItems:"center",padding:"1rem",background:"#f9fafb",borderRadius:"8px",border:"1px solid #e5e7eb"},children:[[1,2,3,4,5].map(e=>t.jsx("button",{type:"button",onClick:()=>I(e),style:{background:"none",border:"none",cursor:"pointer",padding:"0.25rem",transition:"transform 0.15s",lineHeight:1,display:"flex",alignItems:"center",justifyContent:"center"},onMouseEnter:e=>e.currentTarget.style.transform="scale(1.1)",onMouseLeave:e=>e.currentTarget.style.transform="scale(1)",children:t.jsx("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:e>z?"none":"#fbbf24",stroke:e>z?"#d1d5db":"#f59e0b",strokeWidth:"1.5",style:{transition:"all 0.2s"},children:t.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})},e)),z>0&&t.jsx("span",{style:{marginLeft:"1rem",fontSize:"0.875rem",color:"#6b7280",fontWeight:"500"},children:5===z?"MÃ¼kemmel":4===z?"Ã‡ok Ä°yi":3===z?"Ä°yi":2===z?"Orta":"KÃ¶tÃ¼"})]})]}),t.jsxs("div",{style:{marginBottom:"2rem"},children:[t.jsx("label",{style:{display:"block",marginBottom:"0.75rem",fontWeight:"600",fontSize:"0.9375rem",color:"#374151"},children:"Yorumunuz"}),t.jsx("textarea",{value:T,onChange:e=>C(e.target.value),rows:"6",style:{width:"100%",padding:"0.875rem",border:"1px solid #d1d5db",borderRadius:"8px",fontSize:"0.875rem",fontFamily:"inherit",resize:"vertical",transition:"all 0.2s",lineHeight:"1.5",color:"#1f2937",background:"#ffffff"},onFocus:e=>e.currentTarget.style.borderColor="#9ca3af",onBlur:e=>e.currentTarget.style.borderColor="#d1d5db",placeholder:"ÃœrÃ¼n hakkÄ±ndaki dÃ¼ÅŸÃ¼ncelerinizi paylaÅŸÄ±n...",maxLength:2e3}),t.jsxs("div",{style:{marginTop:"0.5rem",fontSize:"0.75rem",color:T.length>1900?"#ef4444":"#9ca3af",textAlign:"right",fontWeight:T.length>1900?"600":"400"},children:[T.length,"/2000 karakter"]})]}),t.jsxs("div",{style:{marginBottom:"2rem"},children:[t.jsxs("label",{style:{display:"block",marginBottom:"0.75rem",fontWeight:"600",fontSize:"0.9375rem",color:"#374151"},children:["FotoÄŸraflar ",t.jsx("span",{style:{fontWeight:"400",color:"#9ca3af",fontSize:"0.8125rem"},children:"(Opsiyonel, en fazla 5)"})]}),t.jsxs("div",{style:{border:"1px dashed #d1d5db",borderRadius:"8px",padding:"1rem",textAlign:"center",background:"#f9fafb",transition:"all 0.2s",marginBottom:"1rem"},onDragOver:e=>{e.preventDefault(),e.currentTarget.style.borderColor="#9ca3af",e.currentTarget.style.background="#f3f4f6"},onDragLeave:e=>{e.currentTarget.style.borderColor="#d1d5db",e.currentTarget.style.background="#f9fafb"},children:[t.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:e=>{const r=Array.from(e.target.files);if(r.length+D.length>5)return void y("En fazla 5 gÃ¶rsel yÃ¼kleyebilirsiniz");const t=[...D,...r];A(t);const i=[];t.forEach(e=>{const r=new FileReader;r.onload=e=>{i.push(e.target.result),i.length===t.length&&R(i)},r.readAsDataURL(e)})},disabled:D.length>=5,style:{width:"100%",padding:"0.625rem",border:"1px solid #d1d5db",borderRadius:"6px",background:5>D.length?"white":"#f3f4f6",cursor:5>D.length?"pointer":"not-allowed",fontSize:"0.8125rem",color:"#374151"}}),D.length>=5&&t.jsx("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.75rem",color:"#ef4444"},children:"Maksimum 5 fotoÄŸraf yÃ¼kleyebilirsiniz"})]}),L.length>0&&t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(120px, 1fr))",gap:"1rem"},children:L.map((e,r)=>t.jsxs("div",{style:{position:"relative",borderRadius:"8px",overflow:"hidden",border:"1px solid #e5e7eb",transition:"transform 0.2s"},onMouseEnter:e=>e.currentTarget.style.transform="scale(1.02)",onMouseLeave:e=>e.currentTarget.style.transform="scale(1)",children:[t.jsx("img",{src:e,alt:"Preview "+(r+1),style:{width:"100%",height:"100px",objectFit:"cover",display:"block"}}),t.jsx("button",{type:"button",onClick:()=>(e=>{const r=D.filter((r,t)=>t!==e),t=L.filter((r,t)=>t!==e);A(r),R(t)})(r),style:{position:"absolute",top:"0.25rem",right:"0.25rem",background:"#ef4444",color:"white",border:"none",borderRadius:"50%",width:"24px",height:"24px",cursor:"pointer",fontSize:"0.875rem",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"bold",transition:"all 0.2s"},onMouseEnter:e=>e.currentTarget.style.background="#dc2626",onMouseLeave:e=>e.currentTarget.style.background="#ef4444",children:"Ã—"})]},r))})]}),t.jsxs("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end",paddingTop:"1.5rem",borderTop:"1px solid #e5e7eb"},children:[t.jsx("button",{onClick:H,disabled:F,style:{padding:"0.75rem 1.5rem",background:"#f3f4f6",color:"#374151",border:"1px solid #e5e7eb",borderRadius:"8px",cursor:"pointer",fontWeight:"500",fontSize:"0.875rem",transition:"all 0.2s"},onMouseEnter:e=>!F&&(e.currentTarget.style.background="#e5e7eb"),onMouseLeave:e=>e.currentTarget.style.background="#f3f4f6",children:"Ä°ptal"}),t.jsx("button",{onClick:async()=>{if(E&&z&&z>=1&&5>=z)if(c){if(P[E.productId])return y("Bu Ã¼rÃ¼ne zaten yorum yaptÄ±nÄ±z. Her Ã¼rÃ¼ne sadece bir kez yorum yapabilirsiniz."),void H();B(!0),y("");try{const e=new FormData;e.append("productId",E.productId.toString()),e.append("rating",z.toString()),T.trim()&&e.append("comment",T.trim()),D.forEach((r,t)=>{e.append("images",r)});const r=await fetch(a+"/reviews",{method:"POST",headers:{...c&&{Authorization:"Bearer "+c}},body:e});if(401===r.status)return u(),y("Oturum sÃ¼reniz dolmuÅŸ. LÃ¼tfen tekrar giriÅŸ yapÄ±n."),H(),void setTimeout(()=>{m("/giris",{state:{returnTo:"/siparislerim"}})},1500);const t=await r.json();if(!r.ok||!t.isSuccess&&!t.success){const e=t.message||"Yorum eklenirken bir hata oluÅŸtu";throw(e.includes("zaten yorum yaptÄ±nÄ±z")||e.includes("sadece bir kez"))&&W(e=>({...e,[E.productId]:!0})),Error(e)}const i=t.message||"Yorumunuz gÃ¶nderildi. Yorumunuz kÄ±sa sÃ¼re iÃ§inde yayÄ±nlanacaktÄ±r.";j(i),W(e=>({...e,[E.productId]:!0})),H(),setTimeout(()=>{(async e=>{if(e&&c)try{const r=await fetch(`${a}/reviews/product/${e}/has-reviewed`,{headers:{Authorization:"Bearer "+c}});if(r.ok){const t=await r.json();t.isSuccess&&!0===t.data?W(r=>({...r,[e]:!0})):W(r=>{const t={...r};return delete t[e],t})}}catch(r){}})(E.productId)},1500),setTimeout(()=>{M()},2e3)}catch(e){y(e.message||"Yorum eklenirken bir hata oluÅŸtu")}finally{B(!1)}}else y("GiriÅŸ yapmanÄ±z gerekiyor");else y("LÃ¼tfen 1-5 arasÄ± bir puan seÃ§in")},disabled:F||!z,style:{padding:"0.75rem 1.5rem",background:z?"#374151":"#d1d5db",color:"white",border:"none",borderRadius:"8px",cursor:z?"pointer":"not-allowed",fontWeight:"600",fontSize:"0.875rem",transition:"all 0.2s",opacity:F?.6:1},onMouseEnter:e=>{z&&!F&&(e.currentTarget.style.background="#1f2937")},onMouseLeave:e=>{e.currentTarget.style.background=z?"#374151":"#d1d5db"},children:F?t.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[t.jsx("span",{style:{display:"inline-block",width:"14px",height:"14px",border:"2px solid rgba(255, 255, 255, 0.3)",borderTopColor:"white",borderRadius:"50%",animation:"spin 0.8s linear infinite"}}),"GÃ¶nderiliyor..."]}):"Yorumu GÃ¶nder"})]})]})]})})]}):null};export{l as default};
