import{u as e,r as s,j as l}from"./react-vendor-2SZXphvN.js";import{a as i}from"./context-Fvoum6Gs.js";import{S as r}from"./SEO-CLq8vwqd.js";import"./vendor-invariant-BME_2b6A.js";import"./vendor-shallowequal-CcIhOdxx.js";import"./vendor-scheduler-BVKd3TJG.js";import"./vendor-@remix-run-BWfEV5os.js";const a="http://localhost:8080/api",t=()=>{const{user:t,accessToken:n,isAuthenticated:o}=i(),c=e(),[h,d]=s.useState(!0),[p,f]=s.useState(!1),[m,u]=s.useState(null),[x,j]=s.useState(""),[g,v]=s.useState(""),[N,y]=s.useState({fullName:"",phone:""});s.useEffect(()=>{o||c("/")},[o,c]),s.useEffect(()=>{o&&n&&b()},[o,n]);const b=async()=>{try{d(!0);const e=await fetch(a+"/user/profile",{headers:{Authorization:"Bearer "+n,"Content-Type":"application/json"}});if(!e.ok)throw Error("Profil bilgileri yüklenemedi");const s=await e.json();if(s.success&&s.data){u(s.data);let e=s.data.phone||"";e&&(e=e.replace(/\D/g,""),e.startsWith("90")&&e.length>10&&(e=e.substring(2)),e.startsWith("0")||10!==e.length||(e="0"+e),e.startsWith("0")&&e.length>1&&"5"!==e[1]&&(e="05"+e.substring(1)),e=e.substring(0,11)),y({fullName:s.data.fullName||"",phone:e})}}catch(e){j("Profil bilgileri yüklenemedi")}finally{d(!1)}};return o?h?l.jsxs("div",{className:"profile-page",children:[l.jsx(r,{title:"Profil - HIEDRA HOME COLLECTION",description:"Kullanıcı profil sayfası"}),l.jsxs("div",{className:"profile-loading",children:[l.jsx("div",{className:"loading-spinner"}),l.jsx("p",{children:"Yükleniyor..."})]})]}):l.jsxs("div",{className:"profile-page",children:[l.jsx(r,{title:"Profil - HIEDRA HOME COLLECTION",description:"Kullanıcı profil sayfası"}),l.jsxs("div",{className:"profile-wrapper",children:[l.jsxs("div",{className:"profile-header",children:[l.jsx("h1",{children:"Profilim"}),l.jsx("p",{children:"Hesap bilgilerinizi görüntüleyin ve güncelleyin"})]}),x&&l.jsxs("div",{className:"profile-alert profile-alert-error",children:[l.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("circle",{cx:"12",cy:"12",r:"10"}),l.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),l.jsx("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]}),l.jsx("span",{children:x})]}),g&&l.jsxs("div",{className:"profile-alert profile-alert-success",children:[l.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),l.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),l.jsx("span",{children:g})]}),l.jsxs("div",{className:"profile-card",children:[l.jsxs("div",{className:"profile-avatar-wrapper",children:[l.jsx("div",{className:"profile-avatar",children:l.jsx("span",{className:"avatar-initials",children:m?.fullName?m.fullName.split(" ").map(e=>e[0]).join("").toUpperCase().substring(0,2):m?.email?.[0]?.toUpperCase()||"U"})}),l.jsxs("div",{className:"profile-user-info",children:[l.jsx("h2",{children:m?.fullName||"Kullanıcı"}),l.jsx("p",{className:"profile-user-email",children:m?.email||""})]})]}),l.jsxs("form",{onSubmit:async e=>{e.preventDefault(),f(!0),j(""),v("");const s=N.phone.replace(/\D/g,"");if(!s.startsWith("05"))return j("Telefon numarası 05 ile başlamalıdır (örn: 05113233289)"),void f(!1);if(s.startsWith("0")){if(11!==s.length)return j("Telefon numarası 11 haneli olmalıdır (örn: 05113233289)"),void f(!1)}else if(10!==s.length)return j("Telefon numarası 10 haneli olmalıdır (örn: 5336360079)"),void f(!1);const l=(e=>{if(!e)return"";let s=e.replace(/\D/g,"");return s.startsWith("90")&&s.length>10&&(s=s.substring(2)),s.startsWith("0")&&(s=s.substring(1)),s.substring(0,10)})(N.phone);try{const e=await fetch(a+"/user/profile",{method:"PUT",headers:{Authorization:"Bearer "+n,"Content-Type":"application/json"},body:JSON.stringify({...N,phone:l})}),s=await e.json();e.ok&&s.success?(u(s.data),v("Profil bilgileriniz başarıyla güncellendi"),setTimeout(()=>v(""),5e3)):j(s.message||"Profil güncellenemedi")}catch(i){j("Profil güncellenirken bir hata oluştu")}finally{f(!1)}},className:"profile-form",children:[l.jsxs("div",{className:"profile-form-group",children:[l.jsxs("label",{htmlFor:"email",className:"profile-form-label",children:[l.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"}),l.jsx("polyline",{points:"22,6 12,13 2,6"})]}),"E-posta Adresi"]}),l.jsx("input",{type:"email",id:"email",value:m?.email||"",disabled:!0,className:"profile-form-input profile-form-input-disabled"}),l.jsx("span",{className:"profile-form-hint",children:"E-posta adresi değiştirilemez"})]}),l.jsxs("div",{className:"profile-form-group",children:[l.jsxs("label",{htmlFor:"fullName",className:"profile-form-label",children:[l.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),l.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),"Ad Soyad ",l.jsx("span",{className:"required",children:"*"})]}),l.jsx("input",{type:"text",id:"fullName",value:N.fullName,onChange:e=>y({...N,fullName:e.target.value}),placeholder:"Adınız ve soyadınız",className:"profile-form-input",required:!0})]}),l.jsxs("div",{className:"profile-form-group",children:[l.jsxs("label",{htmlFor:"phone",className:"profile-form-label",children:[l.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"})}),"Telefon Numarası ",l.jsx("span",{className:"required",children:"*"})]}),l.jsx("input",{type:"tel",id:"phone",value:N.phone,onChange:e=>{let s=e.target.value;s.includes("+")&&(s=s.replace(/\+/g,"")),s.includes("90")&&s.length>2&&(s=s.startsWith("90")?s.substring(2):s.replace(/90/g,""));let l=s.replace(/\D/g,"");l.length>0&&(l.startsWith("5")?l="0"+l:l.startsWith("0")&&l.length>1&&"5"!==l[1]&&(l="05"+l.substring(2))),l=l.startsWith("0")?l.substring(0,11):l.substring(0,10),y({...N,phone:l})},placeholder:"05113233289",className:"profile-form-input",required:!0,minLength:11,maxLength:11,pattern:"05[0-9]{9}"}),l.jsx("span",{className:"profile-form-hint",children:"05 ile başlayan 11 haneli telefon numarası giriniz (örn: 05113233289). +90 girişi yapılamaz."})]}),l.jsxs("div",{className:"profile-form-actions",children:[l.jsx("button",{type:"submit",className:"profile-btn profile-btn-primary",disabled:p,children:p?l.jsxs(l.Fragment,{children:[l.jsx("svg",{className:"btn-spinner",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M21 12a9 9 0 1 1-6.219-8.56"})}),l.jsx("span",{children:"Kaydediliyor..."})]}):l.jsxs(l.Fragment,{children:[l.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}),l.jsx("polyline",{points:"17 21 17 13 7 13 7 21"}),l.jsx("polyline",{points:"7 3 7 8 15 8"})]}),l.jsx("span",{children:"Bilgileri Güncelle"})]})}),l.jsxs("button",{type:"button",className:"profile-btn profile-btn-secondary",onClick:()=>c("/"),disabled:p,children:[l.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),l.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),l.jsx("span",{children:"Ana Sayfaya Dön"})]})]})]})]})]})]}):null};export{t as default};
