import{u as e,r as s,j as a,L as i}from"./react-vendor-2SZXphvN.js";import{a as r}from"./context-Fvoum6Gs.js";import"./vendor-invariant-BME_2b6A.js";import"./vendor-shallowequal-CcIhOdxx.js";import"./vendor-scheduler-BVKd3TJG.js";import"./vendor-@remix-run-BWfEV5os.js";const t="http://localhost:8080/api",c=()=>{const{isAuthenticated:c,accessToken:n}=r(),l=e(),[d,o]=s.useState([]),[m,u]=s.useState(!0),[h,v]=s.useState(""),[p,j]=s.useState("");s.useEffect(()=>{c||l("/giris",{state:{from:"/yorumlarim"}})},[c,l]),s.useEffect(()=>{c&&n&&x()},[c,n]);const x=async()=>{try{u(!0),v("");const e=await fetch(t+"/reviews/my-reviews",{headers:{Authorization:"Bearer "+n,"Content-Type":"application/json"}}),s=await e.json();e.ok&&(s.isSuccess||s.success)?o(s.data||[]):v(s.message||"Yorumlar yüklenemedi")}catch(e){v("Yorumlar yüklenirken bir hata oluştu")}finally{u(!1)}};return c?m?a.jsx("div",{className:"my-reviews-container",children:a.jsxs("div",{className:"loading-state",children:[a.jsx("div",{className:"loading-spinner"}),a.jsx("p",{children:"Yorumlar yükleniyor..."})]})}):a.jsxs("div",{className:"my-reviews-container",children:[a.jsxs("div",{className:"my-reviews-header",children:[a.jsx("h1",{children:"Yorumlarım"}),d.length>0&&a.jsxs("span",{className:"review-count",children:[d.length," ",(d.length,"yorum")]})]}),h&&a.jsx("div",{className:"alert alert-error",children:h}),p&&a.jsx("div",{className:"alert alert-success",children:p}),0===d.length?a.jsxs("div",{className:"no-reviews",children:[a.jsx("p",{children:"Henüz yorum yapmamışsınız."}),a.jsx(i,{to:"/",className:"btn-browse-products",children:"Ürünlere Göz At"})]}):a.jsx("div",{className:"reviews-list",children:d.map(e=>{return a.jsxs("div",{className:"review-card "+(e.active?"":"inactive"),children:[!e.active&&a.jsx("div",{className:"inactive-badge",children:"Silinmiş"}),a.jsxs("div",{className:"review-header",children:[a.jsx("div",{className:"review-product",children:e.product&&a.jsxs(i,{to:"/product/"+e.product.id,className:"product-link",children:[a.jsx("img",{src:e.product.coverImageUrl||e.product.image||"/images/perde1kapak.jpg",alt:e.product.name,className:"product-image"}),a.jsxs("div",{className:"product-info",children:[a.jsx("h3",{children:e.product.name}),a.jsx("p",{className:"product-category",children:e.product.category?.name||"Genel"})]})]})}),a.jsxs("div",{className:"review-rating",children:[a.jsx("div",{className:"stars",children:(r=e.rating||0,Array.from({length:5},(e,s)=>a.jsx("span",{className:r>s?"star filled":"star",children:"★"},s)))}),a.jsxs("span",{className:"rating-value",children:[e.rating,"/5"]})]})]}),e.comment&&a.jsx("div",{className:"review-comment",children:a.jsx("p",{children:e.comment})}),e.imageUrls&&e.imageUrls.length>0&&a.jsx("div",{className:"review-images",children:e.imageUrls.map((e,s)=>a.jsx("img",{src:e,alt:"Yorum fotoğrafı "+(s+1),className:"review-image",onClick:()=>window.open(e,"_blank")},s))}),a.jsxs("div",{className:"review-footer",children:[a.jsxs("span",{className:"review-date",children:[(s=e.createdAt,s?new Date(s).toLocaleDateString("tr-TR",{year:"numeric",month:"long",day:"numeric"}):""),e.updatedAt&&e.updatedAt!==e.createdAt&&a.jsx("span",{className:"updated-badge",children:" (Güncellendi)"})]}),e.active&&a.jsx("div",{className:"review-actions",children:a.jsx("button",{className:"btn-delete",onClick:()=>(async e=>{if(window.confirm("Bu yorumu silmek istediğinize emin misiniz?"))try{v("");const s=await fetch(`${t}/reviews/${e}`,{method:"DELETE",headers:{Authorization:"Bearer "+n,"Content-Type":"application/json"}}),a=await s.json();s.ok&&(a.isSuccess||a.success)?(j("Yorum silindi"),x(),setTimeout(()=>j(""),3e3)):v(a.message||"Yorum silinemedi")}catch(s){v("Yorum silinirken bir hata oluştu")}})(e.id),children:"Sil"})})]})]},e.id);var s,r})})]}):null};export{c as default};
