import{u as e,r as a,j as s}from"./react-vendor-2SZXphvN.js";import{S as t}from"./SEO-CLq8vwqd.js";/* empty css                   */import{a as n}from"./context-DXDbei_0.js";import{u as i}from"./index-DRjqN31K.js";const l="https://api.yusufakin.com.tr/api",r=({contractType:r,seoTitle:c,seoDescription:o,seoUrl:d})=>{const m=e(),{accessToken:h,isAuthenticated:u}=n(),p=i(),[y,j]=a.useState(null),[g,x]=a.useState(!0),[S,v]=a.useState(""),[f,k]=a.useState(!1),[z,N]=a.useState(!1);a.useEffect(()=>{r&&(async()=>{try{x(!0),v("");const e=await fetch(`${l}/contracts/type/${r}`,{headers:{"Content-Type":"application/json",...u&&h&&{Authorization:"Bearer "+h}}});if(!e.ok)return 404===e.status?v("Sözleşme bulunamadı"):v("Sözleşme yüklenirken bir hata oluştu"),void x(!1);const a=await e.json();a.isSuccess||a.success?(j(a.data),u&&a.data&&b(a.data.id)):v(a.message||"Sözleşme yüklenemedi")}catch(e){v("Sözleşme yüklenirken bir hata oluştu")}finally{x(!1)}})()},[r,h,u]);const b=async e=>{if(u&&h)try{const a=await fetch(`${l}/contracts/${e}/status`,{headers:{Authorization:"Bearer "+h,"Content-Type":"application/json"}});if(a.ok){const e=await a.json();(e.isSuccess||e.success)&&k(e.data?.accepted||!1)}}catch(a){}else k(!1)};return g?s.jsxs("div",{className:"legal-page",children:[s.jsx(t,{title:c,description:o,url:d}),s.jsx("div",{className:"legal-container",children:s.jsx("div",{style:{textAlign:"center",padding:"3rem"},children:s.jsx("p",{children:"Yükleniyor..."})})})]}):S&&!y?s.jsxs("div",{className:"legal-page",children:[s.jsx(t,{title:c,description:o,url:d}),s.jsx("div",{className:"legal-container",children:s.jsxs("div",{style:{textAlign:"center",padding:"3rem"},children:[s.jsx("h1",{children:"Hata"}),s.jsx("p",{children:S}),s.jsx("button",{onClick:()=>m("/"),className:"btn btn-primary",style:{marginTop:"1rem"},children:"Ana Sayfaya Dön"})]})})]}):y?s.jsxs(s.Fragment,{children:[s.jsx(t,{title:c,description:o,url:d}),s.jsx("div",{className:"legal-page",children:s.jsxs("div",{className:"legal-container",children:[s.jsxs("div",{className:"legal-header",children:[s.jsx("h1",{children:y.title}),s.jsxs("p",{className:"legal-version",children:["Versiyon: ",y.version]}),s.jsxs("p",{className:"legal-date",children:["Son Güncelleme: ",new Date(y.updatedAt).toLocaleDateString("tr-TR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})]})]}),s.jsx("div",{className:"legal-content",dangerouslySetInnerHTML:{__html:y.content}}),s.jsxs("div",{className:"legal-actions",children:[u&&f?s.jsxs("p",{className:"legal-accepted",children:[s.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{verticalAlign:"middle",marginRight:"0.5rem"},children:s.jsx("polyline",{points:"20 6 9 17 4 12"})}),"Bu sözleşmeyi ",new Date(y.updatedAt).toLocaleDateString("tr-TR")," tarihinde onayladınız."]}):u&&s.jsx("button",{onClick:async()=>{if(u&&y&&h){N(!0),v("");try{const e=await fetch(`${l}/contracts/${y.id}/accept`,{method:"POST",headers:{Authorization:"Bearer "+h,"Content-Type":"application/json"}});if(!e.ok){const a=await e.json().catch(()=>({}));throw Error(a.message||"Sözleşme onaylanamadı")}const a=await e.json();if(a.isSuccess||a.success)k(!0),p.success("Sözleşme başarıyla onaylandı!");else{const e=a.message||"Sözleşme onaylanamadı";v(e),p.error(e)}}catch(e){const a=e.message||"Sözleşme onaylanırken bir hata oluştu";v(a),p.error(a)}finally{N(!1)}}},className:"btn btn-primary",disabled:z,children:z?"Onaylanıyor...":"Sözleşmeyi Oku ve Onayla"}),!u&&s.jsx("p",{style:{marginTop:"1rem",color:"var(--text-secondary)"},children:"Sözleşmeyi onaylamak için giriş yapmalısınız."})]}),s.jsx("div",{className:"legal-footer",children:s.jsx("button",{onClick:()=>m(-1),className:"btn btn-secondary",children:"Geri Dön"})})]})})]}):s.jsxs("div",{className:"legal-page",children:[s.jsx(t,{title:c,description:o,url:d}),s.jsx("div",{className:"legal-container",children:s.jsxs("div",{style:{textAlign:"center",padding:"3rem"},children:[s.jsx("h1",{children:"Sözleşme Bulunamadı"}),s.jsx("p",{children:"Aradığınız sözleşme mevcut değil veya aktif değil."}),s.jsx("button",{onClick:()=>m("/"),className:"btn btn-primary",style:{marginTop:"1rem"},children:"Ana Sayfaya Dön"})]})})]})};export{r as C};
