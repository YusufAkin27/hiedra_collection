import{u as e,r as s,j as a,L as i}from"./react-vendor-2SZXphvN.js";import{u as t,a as r}from"./context-DXDbei_0.js";import{u as n}from"./index-DRjqN31K.js";import{S as l}from"./SEO-CLq8vwqd.js";import"./vendor-invariant-BME_2b6A.js";import"./vendor-shallowequal-CcIhOdxx.js";import"./vendor-scheduler-BVKd3TJG.js";import"./vendor-@remix-run-BWfEV5os.js";const c="https://api.yusufakin.com.tr/api",d=()=>{const d=e(),o=t(),{user:m,accessToken:h,isAuthenticated:u}=r(),p=n(),x=o?.cartItems||[],g=o?.getCartTotal||(()=>0),j=o?.clearCart||(()=>{}),f=o?.couponCode||null,N=o?.discountAmount||0,y=o?.cartId||null,[v,b]=s.useState(!1),[k,S]=s.useState([]),[w,z]=s.useState(null),[C,I]=s.useState(null),[q,D]=s.useState(!1),[A,L]=s.useState(!1),[F,P]=s.useState(!1),[$,T]=s.useState(!1),[B,O]=s.useState(!1),[U,W]=s.useState({firstName:"",lastName:"",email:"",phone:""}),[M,E]=s.useState({address:"",city:"",district:""}),[K,V]=s.useState(!0),[Y,J]=s.useState({address:"",city:"",district:""}),[H,G]=s.useState({cardNumber:"",expiry:"",cvv:""}),[R,_]=s.useState({preInformation:!1,distanceSelling:!1}),[Q,X]=s.useState(!1),[Z,ee]=s.useState(!1);s.useEffect(()=>{u&&h&&(se(),ae())},[u,h]);const se=async()=>{try{const e=await fetch(c+"/user/profile",{headers:{Authorization:"Bearer "+h,"Content-Type":"application/json"}});if(e.ok){const s=await e.json();if(s.isSuccess||s.success){const e=s.data||s;let a="",i="";if(e.fullName){const s=e.fullName.trim().split(/\s+/);a=s[0]||"",i=s.slice(1).join(" ")||""}W({firstName:a,lastName:i,email:e.email||m?.email||"",phone:e.phone||m?.phone||""})}}}catch(e){}},ae=async()=>{try{D(!0);const e=await fetch(c+"/user/addresses",{headers:{Authorization:"Bearer "+h,"Content-Type":"application/json"}});if(e.ok){const s=await e.json();if(s.isSuccess||s.success){const e=s.data||[];S(e);const a=e.find(e=>e.isDefault)||e[0];if(a&&(z(a.id),ie(a),K&&I(a.id),a.fullName)){const e=a.fullName.trim().split(/\s+/);W(s=>({...s,firstName:e[0]||s.firstName,lastName:e.slice(1).join(" ")||s.lastName,phone:a.phone||s.phone}))}}}}catch(e){}finally{D(!1)}},ie=e=>{e&&E({address:e.addressLine,city:e.city,district:e.district})},te=()=>{if(w){const e=k.find(e=>e.id===w);if(e)return`${e.fullName} (${e.district}/${e.city})`}return M.address&&M.city&&M.district?`${M.district}, ${M.city}`:"Adres seçiniz"},re=async e=>{if(e&&(e.preventDefault(),e.stopPropagation()),!v&&(U.firstName.trim()?U.lastName.trim()?U.email.trim()&&U.email.includes("@")?U.phone.trim()&&U.phone.length>=10||(p.warning("Lütfen geçerli bir telefon numarası giriniz."),0):(p.warning("Lütfen geçerli bir e-posta adresi giriniz."),0):(p.warning("Lütfen soyadınızı giriniz."),0):(p.warning("Lütfen adınızı giriniz."),0))&&(w||M.address.trim()&&M.city.trim()&&M.district.trim()?K||C||Y.address.trim()&&Y.city.trim()&&Y.district.trim()||(p.warning("Lütfen fatura adres bilgilerinizi giriniz."),0):(p.warning("Lütfen teslimat adres bilgilerinizi giriniz."),0))&&(()=>{const e=H.cardNumber.replace(/\s/g,"");return e&&16===e.length&&/^\d+$/.test(e)?H.expiry&&/^\d{2}\/\d{2}$/.test(H.expiry)?H.cvv&&3===H.cvv.length&&/^\d+$/.test(H.cvv)?R.preInformation?R.distanceSelling?!!Z||(p.warning("Lütfen sözleşmeyi onaylayınız."),!1):(p.warning("Lütfen mesafeli satış sözleşmesini onaylayınız."),!1):(p.warning("Lütfen ön bilgilendirme koşullarını onaylayınız."),!1):(p.warning("Lütfen geçerli bir CVV giriniz (3 haneli)."),!1):(p.warning("Lütfen geçerli bir son kullanma tarihi giriniz (MM/YY)."),!1):(p.warning("Lütfen geçerli bir kart numarası giriniz (16 haneli)."),!1)})()){b(!0);try{const e=await(async()=>{try{const s=H.cardNumber.replace(/\s/g,""),a=H.expiry,i=x.map(e=>{const s=(e.customizations?.calculatedPrice||e.price)*e.quantity,a=e.customizations?.en||100,i=e.customizations?.boy||200;return{productId:e.id,productName:e.name,width:a,height:i,pleatType:"pilesiz"===e.customizations?.pileSikligi?"1x1":e.customizations?.pileSikligi||"1x1",quantity:e.quantity,price:s}});let t=null;u&&h||(t=localStorage.getItem("guestUserId"));const r={amount:0,cardNumber:s,cardExpiry:a,cardCvc:H.cvv,firstName:U.firstName,lastName:U.lastName,email:U.email,phone:U.phone.replace(/\D/g,""),address:u&&w?null:M.address,city:u&&w?null:M.city,district:u&&w?null:M.district,addressDetail:null,invoiceAddress:K||u&&C?null:Y.address,invoiceCity:K||u&&C?null:Y.city,invoiceDistrict:K||u&&C?null:Y.district,orderDetails:i,frontendCallbackUrl:window.location.origin+"/payment/3d-callback",addressId:u&&w?w:null,invoiceAddressId:u&&!K&&C?C:null,userId:u&&m?.id?m.id:null,cartId:y||null,guestUserId:t,couponCode:f||null},n=await fetch(c+"/payment/card",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}),l=(n.headers.get("content-type"),await n.text());let d;try{if(!l||""===l.trim())return{success:!1,message:"Sunucudan yanıt alınamadı."};d=JSON.parse(l)}catch(e){return l.trim().startsWith("<!DOCTYPE")||l.trim().startsWith("<html")?(sessionStorage.setItem("checkoutData",JSON.stringify({contactInfo:U,addressInfo:M,invoiceAddressInfo:Y,cardInfo:H,items:x,totalPrice:g()})),sessionStorage.setItem("frontendUrl",window.location.origin),document.open(),document.write(l),document.close(),{success:!1,message:"3D Secure yönlendirmesi yapılıyor...",redirecting:!0}):{success:!1,message:"Sunucu yanıtı işlenemedi: "+e.message}}if(n.ok){const e=!0===d.isSuccess||!0===d.success;return e&&d.data&&"string"==typeof d.data&&(d.data.trim().startsWith("<!DOCTYPE")||d.data.trim().startsWith("<html")||d.data.includes("<form"))?(sessionStorage.setItem("checkoutData",JSON.stringify({contactInfo:U,addressInfo:M,invoiceAddressInfo:Y,cardInfo:H,items:x,totalPrice:g()})),sessionStorage.setItem("frontendUrl",window.location.origin),document.open(),document.write(d.data),document.close(),{success:!1,message:"3D Secure yönlendirmesi yapılıyor...",redirecting:!0}):!0===d.requires3D&&d.redirectUrl?(sessionStorage.setItem("checkoutData",JSON.stringify({contactInfo:U,addressInfo:M,invoiceAddressInfo:Y,cardInfo:H,items:x,totalPrice:g()})),sessionStorage.setItem("frontendUrl",window.location.origin),window.location.href=d.redirectUrl,{success:!1,message:"3D Secure yönlendirmesi yapılıyor...",redirecting:!0}):{success:e,message:d.message||(e?"Ödeme başarıyla tamamlandı":"Ödeme işlemi başarısız oldu")}}return{success:!1,message:d.message||`Hata: ${n.status} ${n.statusText}`}}catch(s){return{success:!1,message:s.message||"Ödeme işlemi sırasında bir hata oluştu."}}})();if(e.redirecting)return;if(e.success){const e={orderNumber:"ORD-"+Math.random().toString(36).substring(2,10).toUpperCase(),contactInfo:U,addressInfo:M,invoiceAddressInfo:Y,cardInfo:H,items:x,totalPrice:g()};j(),sessionStorage.removeItem("checkoutData"),d("/siparis-onayi",{state:{orderData:e}})}else b(!1),d("/odeme-basarisiz",{state:{errorMessage:e.message}})}catch(s){b(!1),d("/odeme-basarisiz")}}},ne=(e=>{const s=e.replace(/\s/g,"");return s?/^4/.test(s)?"visa":/^5[1-5]/.test(s)||/^2[2-7]/.test(s)?"mastercard":/^9792/.test(s)?"troy":null:null})(H.cardNumber);if(0===x.length)return a.jsx("div",{className:"checkout-container-mobile",children:a.jsxs("div",{className:"empty-checkout",children:[a.jsx("h2",{children:"Sepetiniz boş"}),a.jsx("p",{children:"Ödeme yapmak için sepetinizde ürün bulunmalıdır."}),a.jsx("button",{onClick:()=>d("/"),className:"shop-btn",children:"Alışverişe Başla"})]})});const le={"@context":"https://schema.org","@type":"CheckoutPage",name:"Ödeme - Hiedra Perde",description:"Hiedra Perde siparişinizi tamamlayın. Güvenli ödeme sistemi ile alışveriş yapın.",url:window.location.href};return a.jsxs("div",{className:"checkout-container-mobile",children:[a.jsx(l,{title:"Ödeme - Perde Satış Ödeme Sayfası",description:"Perde satış ödeme sayfası. Güvenli ödeme sistemi ile siparişinizi tamamlayın. Hiedra Perde ile güvenli alışveriş.",keywords:"perde ödeme, online perde ödeme, perde satış ödeme, güvenli ödeme, perde sipariş ödeme",url:"/checkout",structuredData:le,noindex:!0}),a.jsxs("header",{className:"checkout-header-mobile",children:[a.jsx("button",{className:"back-button",onClick:()=>d(-1),children:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"19",y1:"12",x2:"5",y2:"12"}),a.jsx("polyline",{points:"12 19 5 12 12 5"})]})}),a.jsx("h1",{children:"Güvenli Ödeme"}),a.jsxs("div",{className:"ssl-secured",children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),a.jsx("span",{children:"SSL secured"})]})]}),a.jsx("div",{className:"checkout-content-mobile",children:a.jsxs("form",{onSubmit:re,className:"checkout-form-mobile",children:[a.jsxs("div",{className:"cart-summary-section",children:[a.jsxs("div",{className:"cart-summary-header",onClick:()=>L(!A),children:[a.jsxs("h2",{children:["Sepetimdeki Ürünler (",x.length,")"]}),a.jsx("svg",{className:"expand-icon "+(A?"expanded":""),width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"6 9 12 15 18 9"})})]}),A&&a.jsxs("div",{className:"cart-summary-items",children:[x.map(e=>a.jsxs("div",{className:"cart-summary-item",children:[a.jsx(i,{to:"/product/"+e.id,className:"cart-summary-item-image",children:a.jsx("img",{src:e.image,alt:e.name})}),a.jsxs("div",{className:"cart-summary-item-info",children:[a.jsx(i,{to:"/product/"+e.id,className:"item-name",children:e.name}),e.customizations&&a.jsxs("div",{className:"item-specs",children:[a.jsxs("span",{children:["En: ",e.customizations.en," cm"]}),a.jsxs("span",{children:["Boy: ",e.customizations.boy," cm"]}),a.jsxs("span",{children:["Pile: ","pilesiz"===e.customizations.pileSikligi?"Pilesiz":e.customizations.pileSikligi]})]}),a.jsxs("div",{className:"item-meta",children:[a.jsxs("span",{className:"item-quantity",children:[e.quantity,"x"]}),a.jsxs("span",{className:"item-price",children:[e.subtotal?e.subtotal.toFixed(2):((e.customizations?.calculatedPrice||e.price)*e.quantity).toFixed(2)," ₺"]})]})]})]},e.itemKey||e.id)),N>0&&a.jsx("div",{className:"cart-savings",children:a.jsxs("span",{children:["Kazancın: ",N.toFixed(2)," ₺"]})})]})]}),a.jsxs("section",{className:"address-section",children:[a.jsxs("div",{className:"address-section-header",children:[a.jsx("h2",{children:"Teslimat Adresi"}),u&&a.jsx("button",{type:"button",className:"edit-address-btn",onClick:()=>d("/adresler"),children:"Ekle / Düzenle"})]}),!u||B||u&&0===k.length?a.jsxs("div",{className:"contact-info-fields",children:[u&&k.length>0&&a.jsxs("div",{className:"contact-info-header",children:[a.jsx("h3",{children:"İletişim Bilgileri"}),a.jsx("button",{type:"button",className:"cancel-edit-btn",onClick:()=>O(!1),children:"İptal"})]}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-group",children:[a.jsxs("label",{htmlFor:"firstName",children:["Ad ",a.jsx("span",{className:"required",children:"*"})]}),a.jsx("input",{type:"text",id:"firstName",value:U.firstName,onChange:e=>W({...U,firstName:e.target.value}),placeholder:"Adınız",className:"form-input",required:!0})]}),a.jsxs("div",{className:"form-group",children:[a.jsxs("label",{htmlFor:"lastName",children:["Soyad ",a.jsx("span",{className:"required",children:"*"})]}),a.jsx("input",{type:"text",id:"lastName",value:U.lastName,onChange:e=>W({...U,lastName:e.target.value}),placeholder:"Soyadınız",className:"form-input",required:!0})]})]}),a.jsxs("div",{className:"form-group",children:[a.jsxs("label",{htmlFor:"email",children:["E-posta ",a.jsx("span",{className:"required",children:"*"})]}),a.jsx("input",{type:"email",id:"email",value:U.email,onChange:e=>W({...U,email:e.target.value}),placeholder:"ornek@email.com",className:"form-input",required:!0})]}),a.jsxs("div",{className:"form-group",children:[a.jsxs("label",{htmlFor:"phone",children:["Telefon ",a.jsx("span",{className:"required",children:"*"})]}),a.jsx("input",{type:"tel",id:"phone",value:U.phone,onChange:e=>{let s=e.target.value.replace(/\D/g,"");s.startsWith("90")&&s.length>10&&(s=s.substring(2)),s.startsWith("0")&&(s=s.substring(1)),s.length>10||W({...U,phone:s})},placeholder:"5336360079",maxLength:10,className:"form-input",required:!0})]}),u&&k.length>0&&a.jsx("button",{type:"button",className:"save-contact-btn",onClick:()=>O(!1),children:"Kaydet"})]}):u&&k.length>0&&w?a.jsxs("div",{className:"contact-info-display",children:[a.jsxs("div",{className:"contact-info-display-header",children:[a.jsx("h3",{children:"İletişim Bilgileri"}),a.jsx("button",{type:"button",className:"edit-contact-btn",onClick:()=>O(!0),children:"Düzenle"})]}),a.jsxs("div",{className:"contact-info-display-content",children:[a.jsxs("div",{className:"contact-info-item",children:[a.jsx("span",{className:"contact-info-label",children:"Ad Soyad:"}),a.jsxs("span",{className:"contact-info-value",children:[U.firstName," ",U.lastName]})]}),a.jsxs("div",{className:"contact-info-item",children:[a.jsx("span",{className:"contact-info-label",children:"E-posta:"}),a.jsx("span",{className:"contact-info-value",children:U.email})]}),a.jsxs("div",{className:"contact-info-item",children:[a.jsx("span",{className:"contact-info-label",children:"Telefon:"}),a.jsx("span",{className:"contact-info-value",children:U.phone})]})]})]}):null,a.jsx("div",{className:"address-select-wrapper",children:u&&k.length>0?a.jsxs("div",{className:"address-dropdown",children:[a.jsxs("div",{className:"address-display",onClick:()=>P(!F),children:[a.jsx("span",{children:te()}),a.jsx("svg",{className:"dropdown-icon "+(F?"expanded":""),width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"6 9 12 15 18 9"})})]}),F&&a.jsx("div",{className:"address-dropdown-list",children:k.map(e=>a.jsxs("div",{className:"address-dropdown-item "+(w===e.id?"selected":""),onClick:()=>{(e=>{z(e);const s=k.find(s=>s.id===e);if(s&&(ie(s),K&&(I(e),J({address:s.addressLine,city:s.city,district:s.district})),s.fullName)){const e=s.fullName.trim().split(/\s+/);W(a=>({...a,firstName:e[0]||a.firstName,lastName:e.slice(1).join(" ")||a.lastName,phone:s.phone||a.phone}))}})(e.id),P(!1)},children:[a.jsxs("div",{className:"address-dropdown-content",children:[a.jsx("div",{className:"address-dropdown-name",children:e.fullName}),a.jsx("div",{className:"address-dropdown-line",children:e.addressLine}),a.jsxs("div",{className:"address-dropdown-location",children:[e.district,", ",e.city]})]}),e.isDefault&&a.jsx("span",{className:"default-badge-small",children:"Varsayılan"})]},e.id))})]}):a.jsxs("div",{className:"address-manual-fields",children:[a.jsxs("div",{className:"form-group",children:[a.jsxs("label",{htmlFor:"address",children:["Adres ",a.jsx("span",{className:"required",children:"*"})]}),a.jsx("input",{type:"text",id:"address",value:M.address,onChange:e=>E({...M,address:e.target.value}),placeholder:"Mahalle, Sokak, Cadde",className:"form-input",required:!0})]}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-group",children:[a.jsxs("label",{htmlFor:"city",children:["Şehir ",a.jsx("span",{className:"required",children:"*"})]}),a.jsx("input",{type:"text",id:"city",value:M.city,onChange:e=>E({...M,city:e.target.value}),placeholder:"Şehir adı",className:"form-input",required:!0})]}),a.jsxs("div",{className:"form-group",children:[a.jsxs("label",{htmlFor:"district",children:["İlçe ",a.jsx("span",{className:"required",children:"*"})]}),a.jsx("input",{type:"text",id:"district",value:M.district,onChange:e=>E({...M,district:e.target.value}),placeholder:"İlçe adı",className:"form-input",required:!0})]})]})]})})]}),a.jsxs("section",{className:"address-section",children:[a.jsxs("div",{className:"address-section-header",children:[a.jsx("h2",{children:"Fatura Adresi"}),u&&a.jsx("button",{type:"button",className:"edit-address-btn",onClick:()=>d("/adresler"),children:"Ekle / Düzenle"})]}),a.jsx("div",{className:"form-group",children:a.jsxs("label",{className:"same-address-checkbox",children:[a.jsx("input",{type:"checkbox",checked:K,onChange:e=>{V(e.target.checked),e.target.checked?(I(w),J({address:M.address,city:M.city,district:M.district})):(I(null),J({address:"",city:"",district:""}))}}),a.jsx("span",{className:"checkbox-custom"}),a.jsx("span",{children:"Faturamı aynı adrese gönder."})]})}),!K&&a.jsx("div",{className:"address-select-wrapper",children:u&&k.length>0?a.jsxs("div",{className:"address-dropdown",children:[a.jsxs("div",{className:"address-display",onClick:()=>T(!$),children:[a.jsx("span",{children:(()=>{if(K)return te();if(C){const e=k.find(e=>e.id===C);if(e)return`${e.fullName} (${e.district}/${e.city})`}return Y.address&&Y.city&&Y.district?`${Y.district}, ${Y.city}`:"Adres seçiniz"})()}),a.jsx("svg",{className:"dropdown-icon "+($?"expanded":""),width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"6 9 12 15 18 9"})})]}),$&&a.jsx("div",{className:"address-dropdown-list",children:k.map(e=>a.jsxs("div",{className:"address-dropdown-item "+(C===e.id?"selected":""),onClick:()=>{(e=>{I(e);const s=k.find(s=>s.id===e);s&&J({address:s.addressLine,city:s.city,district:s.district})})(e.id),T(!1)},children:[a.jsxs("div",{className:"address-dropdown-content",children:[a.jsx("div",{className:"address-dropdown-name",children:e.fullName}),a.jsx("div",{className:"address-dropdown-line",children:e.addressLine}),a.jsxs("div",{className:"address-dropdown-location",children:[e.district,", ",e.city]})]}),e.isDefault&&a.jsx("span",{className:"default-badge-small",children:"Varsayılan"})]},e.id))})]}):a.jsxs("div",{className:"address-manual-fields",children:[a.jsxs("div",{className:"form-group",children:[a.jsxs("label",{htmlFor:"invoiceAddress",children:["Fatura Adresi ",a.jsx("span",{className:"required",children:"*"})]}),a.jsx("input",{type:"text",id:"invoiceAddress",value:Y.address,onChange:e=>J({...Y,address:e.target.value}),placeholder:"Mahalle, Sokak, Cadde",className:"form-input",required:!K})]}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-group",children:[a.jsxs("label",{htmlFor:"invoiceCity",children:["Şehir ",a.jsx("span",{className:"required",children:"*"})]}),a.jsx("input",{type:"text",id:"invoiceCity",value:Y.city,onChange:e=>J({...Y,city:e.target.value}),placeholder:"Şehir adı",className:"form-input",required:!K})]}),a.jsxs("div",{className:"form-group",children:[a.jsxs("label",{htmlFor:"invoiceDistrict",children:["İlçe ",a.jsx("span",{className:"required",children:"*"})]}),a.jsx("input",{type:"text",id:"invoiceDistrict",value:Y.district,onChange:e=>J({...Y,district:e.target.value}),placeholder:"İlçe adı",className:"form-input",required:!K})]})]})]})})]}),a.jsxs("section",{className:"card-info-section",children:[a.jsx("div",{className:"card-info-header",children:a.jsx("h2",{children:"Kart Bilgileri"})}),a.jsxs("div",{className:"form-group",children:[a.jsxs("label",{htmlFor:"cardNumber",children:["Kart Numarası ",a.jsx("span",{className:"required",children:"*"})]}),a.jsxs("div",{className:"card-input-wrapper",children:[a.jsx("input",{type:"tel",id:"cardNumber",value:H.cardNumber,onChange:e=>{const s=(e=>{const s=e.replace(/\s/g,"");return(s.match(/.{1,4}/g)?.join(" ")||s).slice(0,19)})(e.target.value);G({...H,cardNumber:s})},placeholder:"1234 5678 9012 3456",maxLength:"19",className:"form-input card-number-input",required:!0}),ne&&a.jsxs("div",{className:"detected-card-icon",children:["visa"===ne&&a.jsx("img",{src:"/images/visa.png",alt:"Visa",className:"detected-card-logo"}),"mastercard"===ne&&a.jsx("img",{src:"/images/master.png",alt:"Mastercard",className:"detected-card-logo"}),"troy"===ne&&a.jsx("img",{src:"/images/troy.png",alt:"Troy",className:"detected-card-logo"})]})]})]}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-group",children:[a.jsxs("label",{htmlFor:"expiry",children:["Son Kullanma Tarihi ",a.jsx("span",{className:"required",children:"*"})]}),a.jsx("input",{type:"text",id:"expiry",value:H.expiry,onChange:e=>{const s=(e=>{const s=e.replace(/\D/g,"");return 0===s.length?"":s.length>2?`${s.slice(0,2)}/${s.slice(2,4)}`:s})(e.target.value);G({...H,expiry:s})},placeholder:"MM/YY",maxLength:"5",className:"form-input",required:!0})]}),a.jsxs("div",{className:"form-group",children:[a.jsxs("label",{htmlFor:"cvv",children:["CVV ",a.jsx("span",{className:"required",children:"*"})]}),a.jsx("input",{type:"tel",id:"cvv",value:H.cvv,onChange:e=>{const s=e.target.value.replace(/\D/g,"");s.length>3||G({...H,cvv:s})},placeholder:"123",maxLength:"3",className:"form-input",required:!0})]})]}),a.jsx("div",{className:"agreements-section",children:a.jsx("div",{className:"agreement-item",children:a.jsxs("label",{className:"agreement-checkbox",children:[a.jsx("input",{type:"checkbox",checked:R.preInformation&&R.distanceSelling,onChange:e=>(async e=>{if(!e)return _({preInformation:!1,distanceSelling:!1}),void ee(!1);X(!0),_({preInformation:!0,distanceSelling:!0});try{const e=localStorage.getItem("guestUserId"),s={"Content-Type":"application/json"};h&&(s.Authorization="Bearer "+h);const a=`${c}/contracts/type/SATIS/accept${e?"?guestUserId="+encodeURIComponent(e):""}`,i=await fetch(a,{method:"POST",headers:s});if(i.ok){const e=await i.json();if(e.isSuccess||e.success)ee(!0),p.success("Sözleşme başarıyla onaylandı!");else{const s=e.message||"Sözleşme onaylanamadı";p.error(s),_({preInformation:!1,distanceSelling:!1}),ee(!1)}}else{const e=(await i.json().catch(()=>({}))).message||"Sözleşme onaylanamadı";p.error(e),_({preInformation:!1,distanceSelling:!1}),ee(!1)}}catch(s){p.error("Sözleşme onaylanırken bir hata oluştu"),_({preInformation:!1,distanceSelling:!1}),ee(!1)}finally{X(!1)}})(e.target.checked),disabled:Q,required:!0}),a.jsx("span",{className:"checkbox-custom"}),a.jsxs("span",{className:"agreement-text",children:[a.jsx(i,{to:"/mesafeli-satis-sozlesmesi",target:"_blank",className:"agreement-link",children:"Ön Bilgilendirme Koşulları"})," ","ve"," ",a.jsx(i,{to:"/mesafeli-satis-sozlesmesi",target:"_blank",className:"agreement-link",children:"Mesafeli Satış Sözleşmesi"}),"'ni okudum, onaylıyorum. ",a.jsx("span",{className:"required",children:"*"})]})]})})})]})]})}),a.jsxs("div",{className:"checkout-bottom-bar",children:[a.jsxs("div",{className:"checkout-total-info",children:[a.jsxs("div",{className:"checkout-total-amount",children:[g().toFixed(2)," ₺"]}),a.jsx("div",{className:"checkout-shipping-text",children:"Kargo Bedava"})]}),a.jsxs("button",{type:"button",onClick:re,className:"checkout-confirm-btn",disabled:v,children:[v?"İşleniyor...":"Onayla ve Bitir",a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"}),a.jsx("polyline",{points:"12 5 19 12 12 19"})]})]})]})]})};export{d as default};
